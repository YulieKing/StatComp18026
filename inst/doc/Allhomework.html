<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="By 18026" />


<title>Homework-2018.09.21</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Homework-2018.09.21</h1>
<h4 class="author"><em>By 18026</em></h4>
<h4 class="date"><em>2018/9/21</em></h4>



<p><font size="4"></p>
<div id="homework-2018.09.14" class="section level2">
<h2>Homework-2018.09.14</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Write a .Rmd file to implement at least three examples of different types in the book “R for Beginners”.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
</div>
<div id="example-1-page_35" class="section level1">
<h1>Example 1 (Page_35)</h1>
<ul>
<li>A simple matrix calculation in R</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A&lt;-<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">3</span>)
B&lt;-<span class="kw">diag</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>)
C&lt;-A<span class="op">%*%</span>B
C</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    2    8   14
## [2,]    4   10   16
## [3,]    6   12   18</code></pre>
</div>
<div id="example-2-page_50" class="section level1">
<h1>Example 2 (Page_50)</h1>
<ul>
<li>An example shows how to Plot the empirical density function</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)
n &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">5</span>)
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(n))
y &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(n, n), <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;n =&quot;</span>, n))
<span class="kw">densityplot</span>(<span class="op">~</span><span class="st"> </span>x <span class="op">|</span><span class="st"> </span>y,
<span class="dt">panel =</span> <span class="cf">function</span>(x, ...) {
<span class="kw">panel.densityplot</span>(x, <span class="dt">col=</span><span class="st">&quot;DarkOliveGreen&quot;</span>, ...)
<span class="kw">panel.mathdensity</span>(<span class="dt">dmath=</span>dnorm,
<span class="dt">args=</span><span class="kw">list</span>(<span class="dt">mean=</span><span class="kw">mean</span>(x), <span class="dt">sd=</span><span class="kw">sd</span>(x)),
<span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>)
})</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-3-page_22" class="section level1">
<h1>Example 3 (Page_22)</h1>
<ul>
<li>Using the function ts to create a time series</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ts</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">47</span>, <span class="dt">frequency =</span> <span class="dv">12</span>, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">2018</span>, <span class="dv">9</span>))</code></pre></div>
<pre><code>##      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
## 2018                                   1   2   3   4
## 2019   5   6   7   8   9  10  11  12  13  14  15  16
## 2020  17  18  19  20  21  22  23  24  25  26  27  28
## 2021  29  30  31  32  33  34  35  36  37  38  39  40
## 2022  41  42  43  44  45  46  47</code></pre>
<div id="homework-2018.09.21" class="section level2">
<h2>Homework-2018.09.21</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<ul>
<li>A discrete random variable X has probability mass function</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">p(x)</td>
<td align="right">0.1</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.3</td>
</tr>
</tbody>
</table>
<ul>
<li>Use the inverse transform method to generate a random sample of size 1000 from the distribution of X. Construct a relative frequency table and compare the empirical with the theoretical probabilities. Repeat using the R sample function.</li>
</ul>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="co">#The inverse transform method</span>
n=<span class="dv">1000</span>                        <span class="co">#size of sample</span>
u=<span class="kw">runif</span>(n)                    <span class="co">#generate u from [0,1] uniform distribution</span>
x=<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>                         <span class="co">#The set of values of variable X </span>
p=<span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">3</span>)           <span class="co">#The probability of X</span>
cp=<span class="kw">cumsum</span>(p)                  <span class="co">#The cumulative probability of X</span>
r=x[<span class="kw">findInterval</span>(u,cp)<span class="op">+</span><span class="dv">1</span>]     <span class="co">#Find the corresponding value of x</span>
ct &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">table</span>(r))     <span class="co">#Compare to the real probability</span>
ct<span class="op">/</span><span class="kw">sum</span>(ct)<span class="op">/</span>p                  <span class="co">#A value close to 1 indicates a more accurate result</span></code></pre></div>
<pre><code>## [1] 0.9900000 0.9850000 1.0550000 0.9900000 0.9833333</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Repeat using the R sample function.</span>
r.sample&lt;-<span class="st"> </span><span class="kw">sample</span>(x, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">prob =</span> p)
ct.sample &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">table</span>(r.sample))
ct.sample<span class="op">/</span><span class="kw">sum</span>(ct.sample)<span class="op">/</span>p     </code></pre></div>
<pre><code>## [1] 0.8500000 1.0600000 1.0250000 1.0000000 0.9933333</code></pre>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<ul>
<li>Write a function to generate a random sample of size n from the Beta(a, b) distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the Beta(3,2) distribution. Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed.</li>
</ul>
</div>
<div id="answer2" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">random.Beta&lt;-<span class="cf">function</span>(a,b,n){
 <span class="cf">if</span>(a<span class="op">&lt;=</span><span class="dv">0</span><span class="op">||</span>b<span class="op">&lt;=</span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;alphas and betas must be positive&quot;</span>)
 <span class="cf">else</span> <span class="cf">if</span>(a<span class="op">&lt;=</span><span class="dv">1</span><span class="op">||</span>b<span class="op">&lt;=</span><span class="dv">1</span>)
   <span class="kw">stop</span>(<span class="st">&quot;The maximum of Beta(a,b) is infinite,so This method is not applicable&quot;</span>)
 <span class="cf">else</span> {
   j&lt;-k&lt;-<span class="dv">0</span>;y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
   <span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n) {
   u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
   j &lt;-<span class="st"> </span>j <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
   x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)      <span class="co">#random variate from g</span>
   x0=(a<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(a<span class="op">+</span>b<span class="op">-</span><span class="dv">2</span>)   <span class="co">#x0 is the maximum point of the theoretical density of Beta(a,b)</span>
   c=<span class="kw">dbeta</span>(x0,a,b)    <span class="co">#c is the maximum of the theoretical density of Beta(a,b)</span>
   <span class="cf">if</span> (x <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>x) <span class="op">&gt;</span><span class="st"> </span>c<span class="op">*</span>u) {             <span class="co">#we accept x</span>
     k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
     y[k] &lt;-<span class="st"> </span>x
     }
   }
}
 <span class="kw">return</span>(y)
}
x=<span class="kw">random.Beta</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1000</span>)
<span class="kw">hist</span>(x, <span class="dt">prob =</span> T, <span class="dt">main =</span><span class="st">&quot;Histogram of random observations</span>
<span class="st">from Beta(3,2)   vs.  The theoretical density of Beta(3,2)&quot;</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))
<span class="kw">curve</span>(<span class="kw">dbeta</span>(x,<span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#random.Beta(3,2,1000)</span>
    ##jie suan fa </code></pre></div>
</div>
<div id="quention-3" class="section level2">
<h2>Quention 3</h2>
<ul>
<li>Simulate a continuous Exponential-Gamma mixture. Suppose that the rate parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(Gamma(\gamma, \beta)\)</span> distribution and Y has <span class="math inline">\(\Lambda\)</span> distribution. That is, <span class="math inline">\((Y |\Lambda = \lambda) \sim f_{Y}(y|\lambda) = \lambda e^{−\lambda y}\)</span>. Generate 1000 random observations from this mixture with <span class="math inline">\(\gamma = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>.</li>
</ul>
</div>
<div id="answer3" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pdf.Y&lt;-<span class="cf">function</span>(x,r,beta){
      y=r<span class="op">*</span>beta<span class="op">^</span>r<span class="op">/</span>((beta<span class="op">+</span>y)<span class="op">^</span>(r<span class="op">+</span><span class="dv">1</span>))
      <span class="kw">return</span>(y)
}
n &lt;-<span class="st"> </span><span class="dv">1000</span> 
r &lt;-<span class="st"> </span><span class="dv">4</span>; beta &lt;-<span class="st"> </span><span class="dv">2</span>
lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, r, beta)
x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, lambda)
<span class="kw">hist</span>(x, <span class="dt">prob =</span> T, <span class="dt">main =</span><span class="st">&quot;Histogram of random observations</span>
<span class="st">from this mixture    vs.  The theoretical density of Y&quot;</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="fl">0.5</span>))
y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, .<span class="dv">1</span>)
<span class="kw">lines</span>(y,<span class="kw">pdf.Y</span>(y,r,beta),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)  ## red line is the theoretical density of Y</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="homework-2018.09.28" class="section level2">
<h2>Homework-2018.09.28</h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<ul>
<li>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2,\cdots, 0.9\)</span> . Compare the estimates with the values returned by the pbeta function in R.</li>
</ul>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">15656</span>)
MC.Beta33&lt;-<span class="cf">function</span>(x){
   m=<span class="dv">10000</span>     <span class="co"># The number of random Numbers</span>
   n=<span class="kw">length</span>(x) 
   y=<span class="ot">NULL</span>
   <span class="cf">if</span>(x<span class="op">&lt;=</span><span class="dv">0</span><span class="op">||</span>x<span class="op">&gt;=</span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;x must be in (0,1)&quot;</span>)
   <span class="cf">else</span> {
     <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
        g=x[i]<span class="op">*</span><span class="kw">dbeta</span>(<span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>x[i]),<span class="dv">3</span>,<span class="dv">3</span>)  <span class="co">#Generate MC random Numbers</span>
        y[i]=<span class="kw">mean</span>(g) <span class="co">#the  estimated values</span>
     }
   }
 <span class="kw">return</span>(y)
}
x=<span class="kw">seq</span>(.<span class="dv">1</span>,.<span class="dv">9</span>,.<span class="dv">1</span>)
ture=<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>) 
y=<span class="kw">MC.Beta33</span>(x) 
<span class="kw">print</span>(ture)   ##print the values returned by the pbeta function in R</code></pre></div>
<pre><code>## [1] 0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208 0.99144</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(y)      ##print the value of simulation by MC method</code></pre></div>
<pre><code>## [1] 0.008549784 0.057771446 0.163162616 0.317300510 0.497325187 0.682830024
## [7] 0.838454793 0.944985202 0.997121358</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(y<span class="op">/</span>ture) ##print the ratio</code></pre></div>
<pre><code>## [1] 0.9988065 0.9974352 1.0005066 0.9995606 0.9946504 1.0003956 1.0018339
## [8] 1.0030838 1.0057304</code></pre>
<ul>
<li>The ratio shows the outcome is ture.</li>
</ul>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<ul>
<li>The Rayleigh density [156, (18.76)] is <span class="math inline">\(f(x)= {x\over\sigma ^{2}} e^{-x^{2}\over2\sigma^{2}}, x&gt;=0,\sigma&gt;0\)</span>. Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(X+X^{'} \over 2\)</span> compared with <span class="math inline">\(X_{1}+X_{2} \over 2\)</span> for independent <span class="math inline">\(X_{1},X_{2}\)</span>?</li>
</ul>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(VGAM)</code></pre></div>
<pre><code>## 载入需要的程辑包：stats4</code></pre>
<pre><code>## 载入需要的程辑包：splines</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MC.Rayleigh&lt;-<span class="cf">function</span>(x,sigma,<span class="dt">antithetic =</span> <span class="ot">TRUE</span>){
   m=<span class="dv">10000</span>     <span class="co"># The number of random Numbers</span>
   n=<span class="kw">length</span>(x) 
   y=<span class="ot">NULL</span>
   <span class="cf">if</span>(x<span class="op">&lt;</span><span class="dv">0</span><span class="op">||</span>sigma<span class="op">&lt;=</span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;x should be non-negative and sigma  should be positive&quot;</span>)
   <span class="cf">else</span> {
     <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
        <span class="co">#Using antithetic variables to generate MC random Numbers</span>
        u=<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>x[i])
        <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>x[i]) <span class="cf">else</span> v &lt;-<span class="st"> </span>x[i] <span class="op">-</span><span class="st"> </span>u
        U=<span class="kw">c</span>(u,v)
        g=x[i]<span class="op">*</span><span class="kw">drayleigh</span>(U, sigma)
        y[i]=<span class="kw">mean</span>(g)  <span class="co">#the  estimated values</span>
     }
   }
 <span class="kw">return</span>(y)
}
##using the rayleigh distribution function in R to check the correctness of the estimation result 
y1=<span class="kw">MC.Rayleigh</span>(<span class="fl">0.3</span>,<span class="dv">1</span>,<span class="dt">antithetic =</span> F)  <span class="co"># the  estimated values without using antithetic variables</span>
y2=<span class="kw">MC.Rayleigh</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)                 <span class="co"># the  estimated values by using antithetic variables</span>
ture=<span class="kw">prayleigh</span>(<span class="fl">0.3</span>, <span class="dv">1</span>)
<span class="kw">print</span>(<span class="kw">c</span>(y1<span class="op">/</span>ture,y2<span class="op">/</span>ture))             <span class="co"># The ratio shows the outcome is ture.</span></code></pre></div>
<pre><code>## [1] 0.9991593 1.0002132</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Computing the percent reduction 
m=<span class="dv">1000</span>
MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {
  MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Rayleigh</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)
  MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Rayleigh</span>(<span class="dv">1</span>, <span class="dv">2</span>)
}
<span class="kw">c</span>(<span class="kw">sd</span>(MC1),<span class="kw">sd</span>(MC2),<span class="kw">sd</span>(MC2)<span class="op">/</span><span class="kw">sd</span>(MC1))</code></pre></div>
<pre><code>## [1] 6.361196e-04 4.816924e-05 7.572356e-02</code></pre>
<ul>
<li>The results show that using antithetic variables can effectively reduce the variance of the estimated results</li>
</ul>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<ul>
<li>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span>and are ‘close’ to <span class="math inline">\(g(x) = {x^2 \over \sqrt{2\pi}} e^{-x^2 \over 2}, x &gt; 1.\)</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math inline">\(\int _{1} ^{\infty} {x^2\over \sqrt{2\pi}} e^{-x^2 \over 2}\)</span> by importance sampling? Explain.</li>
</ul>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">3</span>, .<span class="dv">1</span>)
w &lt;-<span class="st"> </span><span class="dv">2</span>
g &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)
f1 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)
f2&lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">16</span>
gs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">g</span>(x)<span class="op">==</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>e<span class="op">^</span>{<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>}),<span class="kw">expression</span>(f[<span class="dv">1</span>](x)<span class="op">==</span>e<span class="op">^</span>{<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>}<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)),<span class="kw">expression</span>(f[<span class="dv">2</span>](x)<span class="op">==</span>e<span class="op">^</span>{<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span>}<span class="op">*</span>{x<span class="op">^</span><span class="dv">2</span>}<span class="op">/</span><span class="st"> </span><span class="dv">16</span>))
 <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
    <span class="co">#figure (a)</span>
    <span class="kw">plot</span>(x, g, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
         <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">main=</span><span class="st">'(A)'</span>)
    <span class="kw">lines</span>(x,f1, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">2</span>)
    <span class="kw">lines</span>(x,f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)
    <span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> gs,
           <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)

    <span class="co">#figure (b)</span>
    <span class="kw">plot</span>(x, g<span class="op">/</span>f1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
        <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">main=</span><span class="st">'(B)'</span>)
    <span class="kw">lines</span>(x, g<span class="op">/</span>f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)
    <span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> gs[<span class="op">-</span><span class="dv">1</span>],
           <span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAb1BMVEUAAAAAADoAAGYAOjoAOpAAZrYAzQA6AAA6ADo6AGY6OmY6ZpA6kNtmAABmADpmZjpmZmZmtttmtv+QOgCQ2/+2ZgC22/+2/7a2///bkDrbtpDb25Db/9vb////AAD/tmb/25D/27b//7b//9v///8vfE8oAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHl0lEQVR4nO2d6XrbNhBF4dSSu0RdIqut2sZUbL3/M5YEuEvgJcgBBgrv+RFKor7h5AggFoK0uZJJjHYCuUNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBxAW9H55eq21hzKe/qxeXF7dVwuZzNo6nX/4MTUhc0Nk8f622pzKfL9WLj6P5LH2Q0HwaQfZHC0tIWlBz9PdDmc2uS1ELl08nyL0LSEhaUGGaGvb0W1vHXFFSweVz7lLZBSYkLahJ5WSe/31pC5NeHXP5NFn9Y1MKSkhYUFmibb2qcihfN6cjtTpW59NVMZtJSELCgkoxVpAt2ee6up2MWjtW59MKevojNCFhQZe6WtnfqHnTiFKgTmF4kg5KKI6gctMr0TkIckXm26E+JWkL6n6xL9ecBNWpqAsqT40Nu2tOgr4dtQW5k6LrblhRVWIZnaRdpVc8Sbtm9VyPMuoXOTXztugoNvO2G18XnKstSvatZkexctEK+rkcrIYNxmINNXpcXtROQXfzCUsowmB1PM4plAerN+OuoIQiTHfsRp+clKc7xvmEJRRhwmzUQqhPmI0Przxh9r1BQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAggLMl5kj5MuH2lBiY4zl/X5sAShCNIJycZby/p8ZP5D6iVlhGA+LEEogkQavXAUBMJREAhHQSAcBYFwFATCURAIR0EgHAWBcBsXdDJmZ28n9N2Yv3FB5+evpaNddQOE53aQbQv6OJZaCnuv1dlzQ9G2Bb0fyppV2FtlCs8NM9sWxBKEaM9BVlWchGRhKwbIuh+UYE466Ad7qwk7RDxBCSbtg7odb0kFnXNoxZI0Go88ae/vdnDS3vJAJagLl7QVS9HtCAvQPPfGe+N54mY+QbcjrKPYPLKg8D27YNv9oF5B5lDjHrbVcHCweg+WIMS5ORnyHOTBPsLWGP/zd7YuCIejIBCOgkA4CgLhKAiEoyAQjoJAOAoC4TITtM9Z0LI5YFn6+ez3w+3MCJLpSEySy9LLZ1+L2eciKAtyOQdxpf3scHkIaqEgAAUBKAhAQQAKAlAQgIIAFATQEXR58f6Bt20Lai76TCxfyE9Q0tvC6+uFj1SCqn/a4XtvZiGOoLIMVZcMKWiC09PrwwlqSSGoWiNEQZNcXn54UEH9yc2Igu7+PaE23Oo54AVMlej+m1SCJsOtngMOYE63o/8mpaAsFpLP6Xa4jfuNFEuQ1py0r9sxTscKGlxfyaCKpQF1O9zmtpZvRhDqdgTvWPxFS24LySumux3BOxZ/sSLPheST3Y7gHYu/eH3MZcDBOxZ/8fqYC8mDdyz+4vWhS9BNMxbrHPRwC8mbF2ND0eaDHm0hefMikSAcLldB42VKFOTIUNDaSXLhfOrtzTo3NUFXJ+NGCAXV4ZqyMjZEQXW4Rsy4UukKqvwM2zF1QWND+oKGhrQE9a8bZCTIkoUg4zOUgaB5OxZ/cWY4CkLhPIY2LqjXH+zde6AnCPdP9UqQpwhtvAQNwt0tQlkI6rVjFNQdtssnE0H9t8azIxUUBDB3hmHNjtkRJLkZxBvPjkQMWtXhjtkRRMlRkGfH7Aii3IQrDdmaryXId0doRoLMlgTha/P11uVVqal7s2qCxp/ULVms62Lw2ny9fXNTVLbsqAq6+aRe8BZF0Jwrq82L8ZAsG0HXiILmXJtvk+gMuVn8gOMIknYsNr8EVb/S0NAmBM25Nt973a9k2tfF5u9Y/EULvjZ/f81vboL28x96It0P8i2KjiNodrdjhKKgO5/ZqhZF0Pxux/wdi784xLuQ/PYj9wiYGIJCuh2zdyz+4nSUyTngWIL83Y6s56STHMfyQCUIh4t0DgrpdizLJ9JgdeVx5oK7HavziTRYXXccOfIbauS2wmx1PsKD1Tpe79/+Bwqszke4BG1b0IxWY+OCcKuxdUEJEhKGggAUBKAgAAUBshP03UFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAYoIuP7XXOQpj7F+oVkUqHylB74f2QlD197sLbUNi+QgJKrrL0e7i0GknE1g9HxlBhfncXkp0z6TzLSBKg2A+YuegLqEfX68Tl15TIZWPvCBX3dVPQlL5UBCAVQwQQVAGJ+mrXD7ygrJo5uXykReUR0dRLB9ZQR/H6oc65zDUkMqHg1UABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAglqBqRdf7wfeMmPQszieWoGpdl/chQwoszidaFSs+/fWr+iqqHkvziXcOOhntZYpDFuYTT1Dh/yPnKizMJ5qgj+Pv2iuBByzNJ5qg8/N/x3waseX5xBJUPVJQfbV9j8X5xBJ0KptUtwg3Dxbnw540gIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwPX2KNhPp2wmQAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="explain" class="section level2">
<h2>Explain</h2>
<ul>
<li>The function <span class="math inline">\(f_2\)</span> should produce the smaller variance.Because when <span class="math inline">\(x&gt;2\)</span> , the pictures above show that the value of <span class="math inline">\(g/f_1\)</span> is always smaller than <span class="math inline">\(g/f_2\)</span>.</li>
</ul>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<ul>
<li>Obtain a Monte Carlo estimate of <span class="math inline">\(\int _{1} ^{\infty} {x^2\over \sqrt{2\pi}} e^{-x^2 \over 2}\)</span> by importance sampling.</li>
</ul>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g.cut&lt;-<span class="cf">function</span>(x,t){   <span class="co"># t is the lower limit of integral</span>
   n=<span class="kw">length</span>(x)
   y=<span class="kw">numeric</span>(n)
   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
     <span class="cf">if</span>(x[i]<span class="op">&gt;</span>t) y[i]=x[i]<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x[i]<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)
     <span class="cf">else</span> y[i]=<span class="dv">0</span>
   }
   <span class="kw">return</span>(y)
}
MC.g&lt;-<span class="cf">function</span>(t){ <span class="co"># t is the lower limit of integral</span>
   m=<span class="dv">1000000</span>     <span class="co"># The number of random Numbers</span>
   n=<span class="kw">length</span>(t) 
   y=<span class="kw">numeric</span>(n)
     <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
        u=<span class="kw">rchisq</span>(m,<span class="dv">6</span>) 
        G &lt;-<span class="st"> </span><span class="kw">g.cut</span>(u,t[i])
        f2 &lt;-<span class="st"> </span>u<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>u<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">16</span>
        y[i]=<span class="kw">mean</span>(G<span class="op">/</span>f2) <span class="co">#the  estimated values</span>
     }
  <span class="kw">return</span>(y)
} 
<span class="kw">MC.g</span>(<span class="dv">0</span>) ## this outcome shows my program is ture.</code></pre></div>
<pre><code>## [1] 0.4994781</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MC.g</span>(<span class="dv">1</span>) ## the  estimated value</code></pre></div>
<pre><code>## [1] 0.3982884</code></pre>
<ul>
<li>The outcome is <span class="math inline">\(\int _{1} ^{\infty} {x^2\over \sqrt{2\pi}} e^{-x^2 \over 2} \approx 0.3982884\)</span></li>
</ul>
<p>In order to verify the correctness of the program, I also calculate <span class="math inline">\(\int _{0} ^{\infty} {x^2\over \sqrt{2\pi}} e^{-x^2 \over 2}\)</span> by the program,whose true value is 0.5. The outcome shows that <span class="math inline">\(\int _{0} ^{\infty} {x^2\over \sqrt{2\pi}} e^{-x^2 \over 2} \approx 0.4994781\)</span>,which is close to 0.5. So,we can infer the program is ture.</p>
</div>
<div id="homework-2018.10.12" class="section level2">
<h2>Homework-2018.10.12</h2>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<ul>
<li>Let X be a non-negative random variable with <span class="math inline">\(\mu = E[X] &lt; \infty\)</span>. For a random sample <span class="math inline">\(x_1, . . . , x_n\)</span> from the distribution of <span class="math inline">\(X\)</span>, the Gini ratio is defined by <span class="math display">\[G=\frac{1}{2n^2\mu}\sum_{j=1}^{n}\sum_{i=1}^{n}|x_i-x_j|\]</span> The Gini ratio is applied in economics to measure inequality in income distribution (see e.g. [163]). Note that <span class="math inline">\(G\)</span> can be written in terms of the order statistics <span class="math inline">\(x_{(i)}\)</span> as <span class="math display">\[G=\frac{1}{n^2\mu}\sum_{i=1}^{n}(2i-n-1)x_{(i)}\]</span> If the mean is unknown,let <span class="math inline">\(\hat{G}\)</span> be the statistic <span class="math inline">\(G\)</span> with <span class="math inline">\(\mu\)</span> replacedby <span class="math inline">\(\bar{x}\)</span>. Estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat{G}\)</span> if <span class="math inline">\(X\)</span> is standard lognormal. Repeat the procedure for the uniform distribution and Bernoulli(0.1). Also construct density histograms of the replicates in each case.</li>
</ul>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">15411</span>)
<span class="kw">library</span>(MASS)</code></pre></div>
<pre><code>## Warning: 程辑包'MASS'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Gini&lt;-<span class="cf">function</span>(x){
  n&lt;-<span class="kw">length</span>(x)
  a&lt;-<span class="kw">seq</span>(<span class="dv">1</span><span class="op">-</span>n,n<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>)
  x.i&lt;-<span class="kw">sort</span>(x)
  Gini.hat&lt;-<span class="kw">sum</span>(a<span class="op">*</span>x.i)<span class="op">/</span>(n<span class="op">*</span>n<span class="op">*</span><span class="kw">mean</span>(x))
  <span class="kw">return</span>(Gini.hat)
} <span class="co"># you can estimate a G.hat if there comes a sample</span>


## X is standard lognormal
n=<span class="dv">200</span>
m&lt;-<span class="dv">2000</span>
Gini.hat1&lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  y&lt;-<span class="kw">rnorm</span>(n)
  x&lt;-<span class="kw">exp</span>(y) <span class="co"># then x is standard lognormal</span>
  Gini.hat1[i]&lt;-<span class="kw">Gini</span>(x)
}
result1&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(Gini.hat1),<span class="kw">quantile</span>(Gini.hat1,<span class="dt">probs=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.1</span>)))
<span class="kw">names</span>(result1)&lt;-<span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;median&quot;</span>,<span class="st">&quot;deciles&quot;</span>)
<span class="kw">print</span>(result1)</code></pre></div>
<pre><code>##      mean    median   deciles 
## 0.5151976 0.5132331 0.4790989</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Gini.hat1,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="kw">min</span>(Gini.hat1)<span class="op">-</span><span class="fl">0.01</span>,<span class="kw">max</span>(Gini.hat1)<span class="op">+</span><span class="fl">0.01</span>,<span class="fl">0.01</span>),<span class="dt">freq =</span>F,<span class="dt">main =</span> <span class="st">&quot;Histogram of Gini&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Standard lognormal&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## X is uniform
Gini.hat2&lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x&lt;-<span class="kw">runif</span>(n) <span class="co"># then x is uniform</span>
  Gini.hat2[i]&lt;-<span class="kw">Gini</span>(x)
}
result2&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(Gini.hat2),<span class="kw">quantile</span>(Gini.hat2,<span class="dt">probs=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.1</span>)))
<span class="kw">names</span>(result2)&lt;-<span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;median&quot;</span>,<span class="st">&quot;deciles&quot;</span>)
<span class="kw">print</span>(result2)</code></pre></div>
<pre><code>##      mean    median   deciles 
## 0.3323183 0.3316138 0.3101597</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Gini.hat2,<span class="dt">breaks =</span><span class="kw">seq</span>(<span class="kw">min</span>(Gini.hat2)<span class="op">-</span><span class="fl">0.01</span>,<span class="kw">max</span>(Gini.hat2)<span class="op">+</span><span class="fl">0.01</span>,<span class="fl">0.01</span>) ,<span class="dt">freq =</span>F,<span class="dt">main =</span> <span class="st">&quot;Histogram of Gini&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Uniform&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## x is  Bernoulli(0.1)
Gini.hat3&lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x&lt;-<span class="kw">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.1</span>) <span class="co"># then x is Bernoulli(0.1)</span>
  Gini.hat3[i]&lt;-<span class="kw">Gini</span>(x)
}
result3&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(Gini.hat3),<span class="kw">quantile</span>(Gini.hat3,<span class="dt">probs=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.1</span>)))
<span class="kw">names</span>(result3)&lt;-<span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;median&quot;</span>,<span class="st">&quot;deciles&quot;</span>)
<span class="kw">print</span>(result3)</code></pre></div>
<pre><code>##      mean    median   deciles 
## 0.9003075 0.9000000 0.8750000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Gini.hat3,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="kw">min</span>(Gini.hat3)<span class="op">-</span><span class="fl">0.01</span>,<span class="kw">max</span>(Gini.hat3)<span class="op">+</span><span class="fl">0.01</span>,<span class="fl">0.01</span>),<span class="dt">freq =</span>F,<span class="dt">main =</span> <span class="st">&quot;Histogram of Gini&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Bernoulli(0.1)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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kI9Rx5AtZaawUf/bPmMC2ndcfTVky+4b1I1fKgpaxwPUowbNTwNjUKwXum+MzU7DKlyR5PDV1B/v/aD5yTegceMvUBCAhuxliPHxXOwXAQEREBABAREQEAEBERAQAQEREBCHGkAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEDugLLqtFXyJZtxbvJkLHdfrcb54zKyvAW3aas/ZPZZsuzGee44J5sHQHLemHLumFQ9rylftCkW0nahrcZ5JsrQfhtDzTYRC+qB69paZCy/cL0L7ApIJzSYKWP0JDLigz681jwpdmO9tmlcs9UPEacXD7W1yDg3s4s6FdAVUA1FWWat1i9tN3781jaxXM1WexJ/O8jbjeWqi9djA1KlK9KFylaj1Jol326cnb1btwNWzdaUOYrrHoCxWj92DKr+XHk9VrZzZOzGqUx5bE2IXrM1NSSKGx72G6uWFxYgWWcel5pLZo/RbeN0YasVDVsVd/sBKo09zCzquYlVQ4Etx8purO2bk6c1GlMSRWfvXtz1aWJ149EBdYRH63R6dmNdrmaotoTjx6fv+wTp0jg1WS/xwaXLPZ/m9XHKAtunhLUb69zQZq2wnNB7nuZLY/X/2DWo0UUzYaWIQ72MVVkqCaIWW9WNVB96dBR3xmovYwMq+vWmW6NHGKZytwtiM9azfrWJVm1lcqT2ltqHGnbjPARAMxcBAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQ0EiAko57953arGP9L5c34ONWOvDj0/fC6IXba3RtGguQSilI+xMq6cjNLltZHpu1ztryP/PTqIAGvNy+Akj+30gIyszUjqpu+dXIgOJc58qsZPt4E529W79a65QwkxKjTMr2pT5lKq9IbWmSrrJoZfKv/E8+N24TkzUgVSmX8sVcKuFepuib/GCZCWUBJOtNK1exlgLsU6MG6UghUS9OlJl4K9PoRPXQTUgUtw1ImbSyXWuZoT41ag2SmcK6kKJgBQr1Rxe0srYKKO4GNCCq9dSogGSaYlakoloAFY2qBkh91dXE5gZIRNmyFgyqQa2835kCEv+VvZsaoEoMWhWgqjGolfc71xgUm95isgvH+k9xFtveyuToqHkWa6UDz/MsVib2ym5eHVCZGixzel+1+kGNhOIS0Gz6QS7qfE3w3q8O1QQB6f6lVfMZizmpc8Q1o9H8dERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQE9D9qBM7VqyvIuAAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<ul>
<li>Construct an approximate 95% confidence intervalfor the Gini ratio <span class="math inline">\(\gamma=E[G]\)</span> if <span class="math inline">\(X\)</span> is lognormal with unknown parameters. Assess the coverage rate of the estimation procedure with a Monte Carlo experiment.</li>
</ul>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<ul>
<li>Solve: When we get the sample G ,we use <span class="math inline">\(\hat\gamma=\bar{G},\hat\sigma_G=\frac{1}{m-1}\sum_{i=1}^{m}(G_i-\bar{G})^2\)</span> for estimation,and then the approximate 95% confidence interval should be <span class="math inline">\((\bar{G}-\hat{\sigma t_{n-1}(\alpha/2)},\bar{G}+\hat{\sigma t_{n-1}(\alpha/2)})\)</span> And I choose <span class="math inline">\(In(x)\sim N(0,10)\)</span> as the example.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n&lt;-<span class="dv">200</span>
m&lt;-<span class="dv">2000</span>
mu&lt;-<span class="dv">0</span>
sigma&lt;-<span class="dv">10</span>
Gini1&lt;-<span class="cf">function</span>(n,mu,sigma){
  y&lt;-<span class="kw">rnorm</span>(n,mu,sigma)
  x&lt;-<span class="kw">exp</span>(y)
  Gini.sample&lt;-<span class="kw">Gini</span>(x)
  <span class="kw">return</span>(Gini.sample)
}
Gini.sp&lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
Gini.sp[i]&lt;-<span class="kw">Gini1</span>(n,mu,sigma)
}
CI&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(Gini.sp)<span class="op">-</span><span class="kw">sd</span>(Gini.sp)<span class="op">*</span><span class="kw">qt</span>(<span class="fl">0.975</span>,m<span class="op">-</span><span class="dv">1</span>),<span class="kw">mean</span>(Gini.sp)<span class="op">+</span><span class="kw">sd</span>(Gini.sp)<span class="op">*</span><span class="kw">qt</span>(<span class="fl">0.975</span>,m<span class="op">-</span><span class="dv">1</span>))
<span class="kw">print</span>(CI)          <span class="co">#The  approximate 95% conffidence interval </span></code></pre></div>
<pre><code>## [1] 0.9834718 0.9996597</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cover.rate&lt;-<span class="kw">sum</span>(<span class="kw">I</span>(Gini.sp<span class="op">&gt;</span>CI[<span class="dv">1</span>]<span class="op">&amp;</span>Gini.sp<span class="op">&lt;</span>CI[<span class="dv">2</span>]))<span class="op">/</span>m
<span class="kw">print</span>(cover.rate)  <span class="co">#The result can show the CI is efficient.</span></code></pre></div>
<pre><code>## [1] 0.9435</code></pre>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<ul>
<li>Tests for association based on Pearson product moment correlation <span class="math inline">\(\rho\)</span>, Spearman’s rank correlation coeffcient <span class="math inline">\(\rho_{s}\)</span> or Kendall’s coefficient <span class="math inline">\(\tau\)</span>, are implemented in cor.test. Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or<span class="math inline">\(\tau\)</span> are less powerful than the correlation test when the sampled distribution is bivariate normal. Find an example of an alternative (a bivariate distribution (X,Y) such that X and Y are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative.</li>
</ul>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<ul>
<li>Solve: After many attempts, we find that <span class="math display">\[(X,Y)\sim N(0,\Sigma),  \Sigma=
   \left[
   \begin{matrix}
   1.5 &amp; 0.375 \\
   0.375 &amp; 4 
   \end{matrix}\right]
\]</span> is a proper case.And in this case, the ture correlation of X and Y are 0.375</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="dv">1000</span>
sigma1&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">0.375</span>,<span class="fl">0.375</span>,<span class="dv">4</span>),<span class="dv">2</span>,<span class="dv">2</span>)
p.value1=p.value2=p.value3=<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){
x1&lt;-<span class="kw">mvrnorm</span>(<span class="dv">20</span>,<span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">Sigma =</span> sigma1)
p.value1[i]&lt;-<span class="kw">cor.test</span>(x1[,<span class="dv">1</span>],x1[,<span class="dv">2</span>],<span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="op">$</span>p.value
p.value2[i]&lt;-<span class="kw">cor.test</span>(x1[,<span class="dv">1</span>],x1[,<span class="dv">2</span>],<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="op">$</span>p.value
p.value3[i]&lt;-<span class="kw">cor.test</span>(x1[,<span class="dv">1</span>],x1[,<span class="dv">2</span>],<span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="op">$</span>p.value
}
<span class="co">#the power</span>
power&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(p.value1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.value2<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.value3<span class="op">&lt;=</span><span class="fl">0.05</span>))
<span class="kw">names</span>(power)&lt;-<span class="kw">c</span>(<span class="st">&quot;Pearson&quot;</span>,<span class="st">&quot;Spearman&quot;</span>,<span class="st">&quot;Kendall&quot;</span>)
<span class="kw">print</span>(power) ##This result shows that the power of Spearman is bigger than the power of Pearson.</code></pre></div>
<pre><code>##  Pearson Spearman  Kendall 
##    0.080    0.084    0.077</code></pre>
</div>
<div id="homework-2018-11-02" class="section level2">
<h2>Homework-2018-11-02</h2>
</div>
<div id="question1" class="section level2">
<h2>Question1</h2>
<ul>
<li>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)</code></pre></div>
<pre><code>## 
## 载入程辑包：'boot'</code></pre>
<pre><code>## The following objects are masked from 'package:VGAM':
## 
##     logit, simplex</code></pre>
<pre><code>## The following object is masked from 'package:lattice':
## 
##     melanoma</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)</code></pre></div>
<pre><code>## Warning: 程辑包'bootstrap'是用R版本3.5.2 来建造的</code></pre>
<pre><code>## 
## 载入程辑包：'bootstrap'</code></pre>
<pre><code>## The following object is masked from 'package:VGAM':
## 
##     hormone</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG)</code></pre></div>
<pre><code>## Warning: 程辑包'DAAG'是用R版本3.5.2 来建造的</code></pre>
<pre><code>## 
## 载入程辑包：'DAAG'</code></pre>
<pre><code>## The following object is masked from 'package:MASS':
## 
##     hills</code></pre>
</div>
<div id="answer1" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">attach</span>(law)
b.cor&lt;-<span class="cf">function</span>(x,i){
      y=<span class="kw">cor</span>(x[<span class="dv">1</span>,i],x[<span class="dv">2</span>,i])
      <span class="kw">return</span>(y)
}
x=<span class="kw">t</span>(law)
n=<span class="kw">nrow</span>(law)
theta.hat &lt;-<span class="st"> </span><span class="kw">b.cor</span>(x,<span class="dv">1</span><span class="op">:</span>n)
theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
theta.jack[i] &lt;-<span class="st"> </span><span class="kw">b.cor</span>(x,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])
}
bias.jack &lt;-<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)
se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))
<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias=</span>bias.jack,<span class="dt">se=</span>se.jack),<span class="dv">3</span>)</code></pre></div>
<pre><code>## original     bias       se 
##    0.776   -0.006    0.143</code></pre>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<ul>
<li>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2. Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</li>
</ul>
</div>
<div id="answer2-1" class="section level2">
<h2>Answer2</h2>
<ul>
<li>Because they use the quantile of different distribution.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(aircondit)
X=aircondit<span class="op">$</span>hours

mle.boot&lt;-<span class="cf">function</span>(X,i) <span class="kw">mean</span>(X[i])
de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>X,<span class="dt">statistic=</span>mle.boot, <span class="dt">R =</span><span class="dv">1000</span>)
ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))
ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</code></pre></div>
<pre><code>## [1]  31.69677 181.78289</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>## [1]  25.75212 170.89973</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>## [1]  45.26694 190.41455</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ci<span class="op">$</span>bca[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>## [1]  53.32346 214.61424</code></pre>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
<ul>
<li>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</li>
</ul>
</div>
<div id="answer3-1" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(scor)
X=scor
n=<span class="kw">dim</span>(X)[<span class="dv">1</span>]
p=<span class="kw">dim</span>(X)[<span class="dv">2</span>]
eigen=<span class="kw">numeric</span>(p)
A&lt;-<span class="kw">diag</span>(p)
theta.jac=<span class="kw">numeric</span>(n)
eigen=<span class="kw">eigen</span>(<span class="kw">cov</span>(X))<span class="op">$</span>values
theta.hat=<span class="kw">max</span>(eigen)<span class="op">/</span><span class="kw">sum</span>(eigen)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
   A=<span class="kw">cov</span>(scor[<span class="op">-</span>i,])
   eigen=<span class="kw">eigen</span>(A)<span class="op">$</span>values
   theta.jac[i]=<span class="kw">max</span>(eigen)<span class="op">/</span><span class="kw">sum</span>(eigen)
}
bias.jac &lt;-<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jac)<span class="op">-</span>theta.hat)
se.jac &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jac<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))
<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias=</span>bias.jack, <span class="dt">se=</span>se.jack),<span class="dv">3</span>)</code></pre></div>
<pre><code>## original     bias       se 
##    0.619   -0.006    0.143</code></pre>
</div>
<div id="question4" class="section level2">
<h2>Question4</h2>
<ul>
<li>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</li>
</ul>
</div>
<div id="answer4" class="section level2">
<h2>Answer4</h2>
<ul>
<li>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG)
<span class="kw">attach</span>(ironslag)
n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span>
e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="dv">0</span>,n<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>),<span class="kw">rep</span>(<span class="dv">0</span>,n<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))
k=<span class="dv">1</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="op">-</span><span class="dv">1</span>)){
   <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n ){
         y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(i,j)]
         x &lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(i,j)]
         J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
         yhat11 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]
         yhat12 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j]
         e1[k,<span class="dv">1</span>]=yhat11<span class="op">-</span>magnetic[i]
         e1[k,<span class="dv">2</span>]=yhat12<span class="op">-</span>magnetic[j]
         
         J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
         yhat21 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span>
         yhat22 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[j]<span class="op">^</span><span class="dv">2</span>
         e2[k,<span class="dv">1</span>]=yhat21<span class="op">-</span>magnetic[i]
         e2[k,<span class="dv">2</span>]=yhat22<span class="op">-</span>magnetic[j]
         J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
         logyhat31 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]
         yhat31 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat31)
         logyhat32 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j]
         yhat32 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat32)
         e3[k,<span class="dv">1</span>] &lt;-<span class="st">  </span>yhat31<span class="op">-</span>magnetic[i]
         e3[k,<span class="dv">2</span>] &lt;-<span class="st">  </span>yhat32<span class="op">-</span>magnetic[j] 
         J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x)) 
         logyhat41 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i])
         logyhat42 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[j])
         yhat41 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat41)
         yhat42 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat42)
         e4[k,<span class="dv">1</span>] &lt;-<span class="st">  </span>yhat41 <span class="op">-</span>magnetic[i]
         e4[k,<span class="dv">2</span>] &lt;-<span class="st">  </span>yhat42 <span class="op">-</span>magnetic[j]
         k=k<span class="op">+</span><span class="dv">1</span>
    }
}

<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
</div>
<div id="homework-18026-2018-11-16" class="section level2">
<h2>Homework-18026-2018-11-16</h2>
</div>
<div id="question1-1" class="section level2">
<h2>Question1</h2>
<ul>
<li>Implement the two-sample Cramer-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2</li>
</ul>
</div>
<div id="answer1-1" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(boxplotdbl)</code></pre></div>
<pre><code>## Warning: 程辑包'boxplotdbl'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(chickwts)
cvm.ts&lt;-<span class="cf">function</span>(x,y){
  n=<span class="kw">length</span>(x);m=<span class="kw">length</span>(y)
  fn=<span class="kw">ecdf</span>(x);gn=<span class="kw">ecdf</span>(y)
  w2=m<span class="op">*</span>n<span class="op">/</span>((m<span class="op">+</span>n)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(<span class="kw">sum</span>((<span class="kw">fn</span>(x)<span class="op">-</span><span class="kw">gn</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">sum</span>((<span class="kw">fn</span>(y)<span class="op">-</span><span class="kw">gn</span>(y))<span class="op">^</span><span class="dv">2</span>))
  <span class="kw">return</span>(w2)
}
N=<span class="dv">999</span>
x&lt;-<span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed<span class="op">==</span><span class="st">&quot;soybean&quot;</span>]))
y&lt;-<span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed<span class="op">==</span><span class="st">&quot;linseed&quot;</span>]))
<span class="kw">detach</span>(chickwts)
z=<span class="kw">c</span>(x,y)
K=<span class="dv">1</span><span class="op">:</span><span class="dv">26</span>
reps=<span class="kw">numeric</span>(N)
cvm0=<span class="kw">cvm.ts</span>(x,y)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {
  k&lt;-<span class="kw">sample</span>(K,<span class="dt">size =</span> <span class="dv">14</span>,<span class="dt">replace =</span> F)
  x1&lt;-z[k]
  y1&lt;-z[<span class="op">-</span>k]
  reps[i]&lt;-<span class="kw">cvm.ts</span>(x1,y1)
}
p&lt;-<span class="kw">mean</span>(<span class="kw">c</span>(cvm0,reps)<span class="op">&gt;=</span>cvm0)
p<span class="co">#0.421 does not support the alternative hypothesis that distributions differ</span></code></pre></div>
<pre><code>## [1] 0.421</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(reps,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">freq=</span>F,<span class="dt">xlab=</span><span class="st">&quot;W2(p=0.421)&quot;</span>,<span class="dt">breaks =</span> <span class="st">&quot;scott&quot;</span>)
<span class="kw">points</span>(cvm0,<span class="dv">0</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">pch=</span><span class="dv">16</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>0.421 does not support the alternative hypothesis that distributions differ.</li>
</ul>
</div>
<div id="quention2" class="section level2">
<h2>Quention2</h2>
<ul>
<li>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.
<ul>
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
<li>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</li>
</ul></li>
</ul>
</div>
<div id="answer2-2" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Ball)</code></pre></div>
<pre><code>## Warning: 程辑包'Ball'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(energy)</code></pre></div>
<pre><code>## Warning: 程辑包'energy'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)
<span class="kw">library</span>(RANN)</code></pre></div>
<pre><code>## Warning: 程辑包'RANN'是用R版本3.5.2 来建造的</code></pre>
</div>
<div id="design-experiments" class="section level2">
<h2>Design experiments</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="fl">1e2</span>;k&lt;-<span class="dv">3</span>;p&lt;-<span class="dv">2</span>;mu&lt;-<span class="fl">0.5</span>;R&lt;-<span class="dv">999</span>;
p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)

Tn&lt;-<span class="cf">function</span>(z,ix,sizes,k){
n1&lt;-sizes[<span class="dv">1</span>];n2&lt;-sizes[<span class="dv">2</span>];n&lt;-n1<span class="op">+</span>n2
<span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z&lt;-<span class="kw">data.frame</span>(z,<span class="dv">0</span>)
z&lt;-z[ix, ]
NN&lt;-<span class="kw">nn2</span>(<span class="dt">data=</span>z,<span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)
block1&lt;-NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] 
block2&lt;-NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] 
i1&lt;-<span class="kw">sum</span>(block1 <span class="op">&lt;=</span><span class="st"> </span>n1)
i2&lt;-<span class="kw">sum</span>(block2 <span class="op">&gt;</span>n1) 
(i1<span class="op">+</span>i2)<span class="op">/</span>(k<span class="op">*</span>n)
}

eqdist.nn&lt;-<span class="cf">function</span>(z,sizes,k){
boot.obj&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>sizes,<span class="dt">k=</span>k)
ts&lt;-<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
p.value&lt;-<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
<span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}</code></pre></div>
<ul>
<li>Unequal variances and equal expectations</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n1&lt;-n2&lt;-<span class="dv">50</span>;n&lt;-n1<span class="op">+</span>n2;N=<span class="kw">c</span>(n1,n2);mu1=mu2=<span class="dv">0</span>;sigma1=<span class="dv">1</span>;sigma2=<span class="dv">2</span>  
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
x&lt;-<span class="kw">rnorm</span>(n1,mu1,sigma1)
y&lt;-<span class="kw">rnorm</span>(n2,mu2,sigma2)
z&lt;-<span class="kw">c</span>(x,y)
p.values[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
p.values[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
p.values[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha&lt;-<span class="fl">0.1</span>
pow&lt;-<span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
pow</code></pre></div>
<pre><code>## [1] 0.68 0.92 0.94</code></pre>
<ul>
<li>Unequal variances and unequal expectations</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n1&lt;-n2&lt;-<span class="dv">50</span>;n&lt;-n1<span class="op">+</span>n2;N=<span class="kw">c</span>(n1,n2);mu1=<span class="dv">1</span>;mu2=<span class="dv">2</span>;sigma1=<span class="dv">1</span>;sigma2=<span class="dv">2</span>   
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
x&lt;-<span class="kw">rnorm</span>(n1,mu1,sigma1)
y&lt;-<span class="kw">rnorm</span>(n2,mu2,sigma2)
z&lt;-<span class="kw">c</span>(x,y)
p.values[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
p.values[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
p.values[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha&lt;-<span class="fl">0.1</span>
pow&lt;-<span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
pow</code></pre></div>
<pre><code>## [1] 0.86 0.99 0.99</code></pre>
<ul>
<li>t distribution with 1 df,bimodel distribution</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n1&lt;-n2&lt;-<span class="dv">50</span>;n&lt;-n1<span class="op">+</span>n2;N=<span class="kw">c</span>(n1,n2);mu1=<span class="dv">1</span>;mu2=<span class="dv">2</span>;sigma1=<span class="dv">1</span>;sigma2=<span class="dv">2</span>  
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
x&lt;-<span class="kw">rt</span>(n1,<span class="dv">1</span>)
y&lt;-<span class="kw">c</span>(<span class="kw">rnorm</span>(n2<span class="op">/</span><span class="dv">2</span>,mu1,sigma1),<span class="kw">rnorm</span>(n2<span class="op">/</span><span class="dv">2</span>,mu2,sigma2))
z&lt;-<span class="kw">c</span>(x,y)
p.values[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
p.values[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
p.values[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha&lt;-<span class="fl">0.1</span>
pow&lt;-<span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
pow</code></pre></div>
<pre><code>## [1] 0.87 1.00 0.99</code></pre>
<ul>
<li>Unbalanced samples</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n1&lt;-<span class="dv">10</span>;n2&lt;-<span class="dv">100</span>;n&lt;-n1<span class="op">+</span>n2;N=<span class="kw">c</span>(n1,n2) 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
x&lt;-<span class="kw">rnorm</span>(n1)
y&lt;-<span class="kw">rnorm</span>(n2)
z&lt;-<span class="kw">c</span>(x,y)
p.values[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
p.values[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
p.values[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha&lt;-<span class="fl">0.1</span>
pow&lt;-<span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha) 
pow</code></pre></div>
<pre><code>## [1] 0.10 0.07 0.07</code></pre>
</div>
<div id="question3-1" class="section level2">
<h2>Question3</h2>
<ul>
<li>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy(<span class="math inline">\(\theta, \eta\)</span>) distribution has density function <span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;\infty,\theta&gt;0\]</span> The standard Cauchy has the Cauchy<span class="math inline">\(\theta=1, \eta=0\)</span>) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</li>
</ul>
</div>
<div id="answer3-2" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> f_cauchy&lt;-<span class="cf">function</span>(x,u,lamada){
    <span class="kw">return</span>(lamada<span class="op">/</span>(pi<span class="op">*</span>(lamada<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(x<span class="op">-</span>u)<span class="op">^</span><span class="dv">2</span>)))
} <span class="co">#the density function of cauchy</span>

cauchy.chain&lt;-<span class="cf">function</span>(n,sigma,x0,u,lamada){
    <span class="co">#n:length of the chain</span>
    <span class="co">#sigma:standard error of the proposal distribution</span>
    <span class="co">#x0:initial value</span>
    <span class="co">#u,lamada:parameter of cauchy distribution</span>
    x&lt;-<span class="ot">NULL</span>
    x[<span class="dv">1</span>]&lt;-x0
    e=<span class="kw">runif</span>(n)
    k&lt;-<span class="dv">0</span>
    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){
      y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="op">-</span><span class="dv">1</span>],sigma)
      <span class="cf">if</span>(e[i]<span class="op">&lt;=</span>(<span class="kw">f_cauchy</span>(y,u,lamada)<span class="op">/</span><span class="kw">f_cauchy</span>(x[i<span class="op">-</span><span class="dv">1</span>],u,lamada)))  x[i]&lt;-y
      <span class="cf">else</span>{
      x[i]&lt;-x[i<span class="op">-</span><span class="dv">1</span>]
      k&lt;-k<span class="op">+</span><span class="dv">1</span>
      }
    }
    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>k))
  } 
  n&lt;-<span class="dv">10000</span>
  cauchy&lt;-<span class="kw">cauchy.chain</span>(n,<span class="dt">sigma=</span><span class="fl">0.5</span>,<span class="dt">x0=</span><span class="dv">0</span>,<span class="dt">u=</span><span class="dv">0</span>,<span class="dt">lamada=</span><span class="dv">1</span>)
  refuse.pr&lt;-cauchy<span class="op">$</span>k<span class="op">/</span>n
  refuse.pr</code></pre></div>
<pre><code>## [1] 0.1328</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="co">#qq plot</span>
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
  <span class="kw">qqplot</span>(<span class="kw">rcauchy</span>(n<span class="op">-</span><span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>),cauchy<span class="op">$</span>x[<span class="dv">1001</span><span class="op">:</span>n])
  <span class="kw">qqline</span>(cauchy<span class="op">$</span>x[<span class="dv">1001</span><span class="op">:</span>n])</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAb1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZrY6kNtmAABmADpmOpBmkJBmtrZmtttmtv+QOgCQOmaQZgCQkGaQ27aQ2/+2ZgC2Zjq225C2///bkDrb2//b////tmb/25D//7b//9v///8UNOmCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI7UlEQVR4nO2di5abNhRFaepJH+Np03Ef4za0+PH/31j0AmyDjiQuSCZnr5WMY4srvCOEhDRSdSVeqtwnUDoUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDACDrvqyGfvmY+q4Jwgt4H7zUU1ENBANZBgF7Q5cAKaIRe0FHCTPU0RAs671/n+1nwivVGjvnCJmmKoHdfuthw4kxGtsUhMOdq8Ccu38thF3pMSDhxpiJXSlFw1lV3THy+TSVQhNYV1BWe4DIxQ1DXmJ5VV68pSNtZT5AMywq6uQMZPaYIhX/j9DpIhkUFWTvVTbFx4oLjpN7FZFhSUFd+KnONVN27SeFiE7p2UF1qHVTdC+pvYCnhxBNmCTeMbNUMrrGY9uFDOPGEWcINIxtDnZ9ZejYoKKkf5YsnnjBLuD6uoBsTMC7h8JFrkZW0tJ/oEnQ5yDwG2qwgob7q0oIEA0YnFOmrblnQyvnGxqUgEJeCQNzsgoTGNDYrqK7sI/ummn52b/qzjU/jVgVdDp2W+vv/ptJqQfrzySf8WxU0+MKecWclyKac0rhVQeEl6PSiBd1pFO1Hjp1lbkFtHWSLEKqD8pSg/IK67up0+XFpdlfPMOx2BQXSOvruw1PMlhUkGVE8YZZwXdj8gspuKOYXFNRQlMw3MmxuQWG3ecl8I8PmFhTWUJTMNzJsbkEsQShhUENRMt/IsNkFBTUUJfONDJtf0Nr5RoalIBCWgkBYCgJhcwsqfeg5u6DSh57zCyp86LkAQWUPPZcgaOV8I8NSEAibW5DYbxxSkFS+kWHzC6qGUFBCwizhurAFCLr8u2q+kWELEHTe7/TPy+/saownbNSQ4LVmX2wyoRka8z5xhaNnmxakv763v4FHzzYt6FhVvx18D6UDxj42LKhtCpkJdr4JVFOjZ30TKvI8AylC0C+mTHjuYt92CQoBj55tV9BRFYm6ArU0HD3brKBatYGa9i87B3HxfCPD5hakm9HmqeuRY/MjCY83nfkZo/NbFaQnZaorjCVoIuHx01dzhXF2x0TCo7k11fP8bFjQ2vlGhqUgELYAQW0bcLdivpFhCxBk2tFzF3rbtKCrgKOtCzKKZjx03bigRndWL4f0tuKWBameujHDkdWxhOe97mmslW9k2AIErZxvZNgSBIn8QtSWBcmsBjw/xGjYAgQVvRpwGYI4R9GbsOjVgEsQNPdxfWS+kWFzC+JM+/kJrzlXf3kmQVlWfylDkBrP8D6zz752h2TE+IRmvMfNxBtjevWX+HzjKEGQu2pKXD+oKkGQm9viWU862+ovRQiyc1tOL94ex8TqL30jIe40AylDUOumPYeZD4UWFSQaUjxhz2CimUS4ACgIUISg8I1HvlFBloAH9t+2oOtxhw5ZXdASd8h0QQWuH1SWoAI3HilKkK8vJplvTMwl2qDpd7F5CwhtWNDK+UaEpCBvwIV6eYmTF4IaiiL5hsS6RTDyNfWBWb0T+VWEiW8T+S3tXlDFCFKPeJq2hp6/TKD7c/9RdY3ZDsxsIlaUoPfr6Yev+s+sfKvxE7A750WcmBHq9GQXpDoQ57ePQgXlu5sMnii2tfPxdf4lJiRoUAeNB5xH0rDPTt3J5k2CkauD7huIBQgSy1fmLjYWWY7NNBSXipx0iaGR1ZBwT0O8IDyyGulKNJl4ulBu2kGKeQ/MxiKLJMsvKGBkNTGySLL8gsJGVpMiSyQrQJDIyOp4ZIFkJQjKE5mChE6AglZOFwoFrRxvc1AQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCCAsCAzNNK4J5OPL9KYPlyvF/E6ntfMTA2ygho9xVEtyNi4tU9vXySGnTz8cmjfrtWvaIlnahEVdN4rQWZ85LgbeZGG53Az36tWq0AKZ+oQFVR//0crqDvpxxdpYeHhbTkRz9QhKej0+UPVQe2Pqx6AfHyRHNd/+HEsr5mZOgQFqTKtx/f1dd/+/fgiLTA6XE0oEM/UIShITb3KIahxdXThgnSRznCJmQkpZV9ievnF2s4reV+3krbL8z5FJX01JWjN23y3D8Fz3OZtS3rFhmI/1+IpGoquq1G7Nv7jizQmD7fXtdm2SThTAzurAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgq6CH/Usuh+k1+OzaYQGzfUem/+qD1Qpk0ZQlqN550uqZPgGTOEZmdbiDE5YfK0qQZ4+zxqyAGTANaGRekD3YW0CnWEjQ+e1PdU5qdsruqjdrVxOdtAD9l/ngvP/1RX2gv01betR8ufP+y76q7r9IU73qyXQBE8keZ5a5g6f3S/GwlKC93r2+LehqAUslwLy2guwHeuvS9rU6ffW/q9K59x5CGkF4KuLo3ET7z4T5VIsJeu33b9GVo/qPdYK6D9TP9gO9yOXnj/6gsQVT9XcMmMw6OrvVCkpYiHUxQe+3p9Ooy8YJch90JaotOm3p76/AscpIQlDCTpeLCvpsT7KtcT79MyhB7oNORnv+R7vzlF/QzEusNEG2oOifw0vsoQSd3/56G1RR3R5U1WB39/RK+lqqIHc65uLQl5irc16HqdQG5T+2lbqtg3wlKO02X2odpG9Gl8POFJ62LKiN2i+H6t19MLztu2/lF5TYUCzxLtZdIzs7H/eob+1V9WXYDnq/qa5MO8graHq2b79R7MMb/cHFtINiOf1kVrmcsxz66Wf0Rkr8QgTVdhHH3YwYzX0F/PjGs/XFHKcXe+YpnaWOv+/rl/s3nq83/wxQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/S0MPa5rvMWEAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="co">#histplot</span>
  <span class="kw">hist</span>(cauchy<span class="op">$</span>x[<span class="dv">1001</span><span class="op">:</span>n],<span class="dt">freq=</span>F,<span class="dt">main=</span><span class="st">&quot;density of cauchy&quot;</span>,<span class="dt">breaks=</span><span class="dv">60</span>)
  <span class="kw">curve</span>(<span class="kw">f_cauchy</span>(x,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question4-1" class="section level2">
<h2>Question4</h2>
<ul>
<li>Rao [220, Sec. 5g] presented an example on genetic linkage of 197 animals in four categories (also discussed in [67, 106, 171, 266]). The group sizes are (125,18,20,34). Assume that the probabilities of the corresponding multinomial distribution are <span class="math display">\[(\frac{1}{2}+\frac{\theta}{4}, \frac{1-\theta}{4}, \frac{1-\theta}{4},\frac{\theta}{4})\]</span>. Estimate the posterior distribution of <span class="math inline">\(\theta\)</span> given the observed sample, using one of the methods in this chapter.</li>
</ul>
</div>
<div id="answer4-1" class="section level2">
<h2>Answer4</h2>
<ul>
<li>The posterior distribution of <span class="math inline">\(\theta\)</span> given <span class="math inline">\((x_1,x_2,x_3,x_4)=(125,18,20,34)\)</span> is therefore <span class="math display">\[Pr(\theta|(x_1,x_2,x_3,x_4))=\frac{197!}{x_1!x_2!x_3!x_4!}p_1^{x_1}p_2^{x_2}p_3{x_3}p_4^{x_4}\]</span>.where <span class="math inline">\((p_1,p_2,p_3,p_4)=(\frac{1}{2}+\frac{\theta}{4}, \frac{1-\theta}{4}, \frac{1-\theta}{4},\frac{\theta}{4})\)</span></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  w &lt;-<span class="fl">0.25</span> <span class="co">#width of the uniform support set </span>
  n &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#length of the chain </span>
  burn &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in time </span>
  y&lt;-<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) <span class="co">#the chain</span>
  
  prob &lt;-<span class="st"> </span><span class="cf">function</span>(b, y) { 
    <span class="co"># computes (without the constant) the target density </span>
    <span class="cf">if</span> (b <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>b <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">return</span> (<span class="dv">0</span>)
    <span class="kw">return</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>b<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>y[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>b)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>y[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>b)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>y[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>(b<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>y[<span class="dv">4</span>])
  }
  
  u &lt;-<span class="st"> </span><span class="kw">runif</span>(n) <span class="co">#for accept/reject step</span>
  v &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="op">-</span>w, w) <span class="co">#proposal distribution </span>
  x[<span class="dv">1</span>] &lt;-<span class="fl">0.25</span> 
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n) { 
    z &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>v[i] 
    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">prob</span>(z,y) <span class="op">/</span><span class="st"> </span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>],y)) 
      x[i] &lt;-z 
    <span class="cf">else</span> 
      x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>] 
  }
  
   xb &lt;-<span class="st"> </span>x[(burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n]
   xc&lt;-<span class="kw">mean</span>(xb)
   <span class="kw">print</span>(xc)  <span class="co">#estimation value of theta</span></code></pre></div>
<pre><code>## [1] 0.622604</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw">print</span>(y<span class="op">/</span><span class="kw">sum</span>(y))</code></pre></div>
<pre><code>## [1] 0.63451777 0.09137056 0.10152284 0.17258883</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw">print</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>xc<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>xc)<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>xc)<span class="op">/</span><span class="dv">4</span>,xc<span class="op">/</span><span class="dv">4</span>))</code></pre></div>
<pre><code>## [1] 0.65565101 0.09434899 0.09434899 0.15565101</code></pre>
</div>
<div id="homework-18026-2018-11-23" class="section level2">
<h2>Homework-18026-2018-11-23</h2>
</div>
<div id="question1-2" class="section level2">
<h2>Question1</h2>
<ul>
<li>For exercise 9.6, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until the chain has converged approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</li>
</ul>
</div>
<div id="answer1-2" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {
  psi&lt;-<span class="kw">as.matrix</span>(psi)        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span>
  n&lt;-<span class="kw">ncol</span>(psi)               <span class="co"># for chain in i-th row of X</span>
  k&lt;-<span class="kw">nrow</span>(psi)
  psi.means&lt;-<span class="kw">rowMeans</span>(psi)   <span class="co">#row means</span>
  B&lt;-n<span class="op">*</span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span>
  psi.w&lt;-<span class="kw">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span>
  W&lt;-<span class="kw">mean</span>(psi.w)             <span class="co">#within est.</span>
  v.hat&lt;-W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n<span class="op">+</span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span>
  r.hat&lt;-v.hat<span class="op">/</span>W             <span class="co">#G-R statistic</span>
  <span class="kw">return</span>(r.hat)
}       

prob&lt;-<span class="cf">function</span>(y,ob){ <span class="co"># computes the target density </span>
  <span class="cf">if</span>(y <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>){
    <span class="kw">return</span>(<span class="dv">0</span>)
    }
  <span class="cf">else</span>{
    <span class="kw">return</span>((<span class="fl">0.5</span><span class="op">+</span>y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>ob[<span class="dv">1</span>]<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>ob[<span class="dv">2</span>]<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>ob[<span class="dv">3</span>]<span class="op">*</span>(y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>ob[<span class="dv">4</span>])
    }
}

mult.chain&lt;-<span class="cf">function</span>(ob,w,m,x1){
   x&lt;-<span class="kw">numeric</span>(m)      <span class="co">#the chain</span>
   u&lt;-<span class="kw">runif</span>(m)        <span class="co">#for accept/reject step </span>
   v&lt;-<span class="kw">runif</span>(m,<span class="op">-</span>w,w)   <span class="co">#proposal distribution </span>
   x[<span class="dv">1</span>]&lt;-x1 
   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) { 
   y&lt;-x[i<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span>v[i] 
      <span class="cf">if</span>(u[i]<span class="op">&lt;=</span><span class="kw">prob</span>(y,ob)<span class="op">/</span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>],ob)){
            x[i]&lt;-y
      }
   <span class="cf">else</span>{ 
            x[i]&lt;-x[i<span class="op">-</span><span class="dv">1</span>]} 
   }
   <span class="kw">return</span>(x)
}

w&lt;-.<span class="dv">5</span>               <span class="co">#width of the uniform support set </span>
ob&lt;-<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>) <span class="co">#the observed sample</span>
m&lt;-<span class="dv">10000</span>            <span class="co">#length of the chain </span>
burn&lt;-<span class="dv">1000</span>          <span class="co">#burn-in time </span>
k&lt;-<span class="dv">4</span>                <span class="co">#number of chains to generate</span>
x0&lt;-<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.75</span>)  <span class="co">#choose overdispersed initial values</span>

<span class="co">#generate the chains</span>
X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){
  X[i, ]&lt;-<span class="kw">mult.chain</span>(ob,w,m,x0[i])
}
    
psi&lt;-<span class="kw">t</span>(<span class="kw">apply</span>(X,<span class="dv">1</span>,cumsum)) <span class="co">#compute diagnostic statistics</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)){
  psi[i,]&lt;-psi[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))
}

<span class="co"># chain has approximately converged to the target distribution within approximately 3000 iterations </span></code></pre></div>
</div>
<div id="question2-1" class="section level2">
<h2>Question2</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P( t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}} )\]</span> and <span class="math display">\[S_{k}(a)=P( t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}} ),\]</span> for <span class="math inline">\(k=4:25,100,500,1000,\)</span> where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by <span class="math inline">\(Sz\acute{e}kely\)</span> [260].) ## Answer2</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ak&lt;-<span class="cf">function</span>(a,k){     
  t1&lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))
  t2&lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)) 
  <span class="kw">return</span>(<span class="kw">pt</span>(t1,<span class="dt">df=</span>k<span class="op">-</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">pt</span>(t2,<span class="dt">df=</span>k))
}
##Function Ak=0 means that two curves  intersect.

K=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)
ipts=<span class="kw">numeric</span>(<span class="kw">length</span>(K))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(K)){
    ipts[i]=<span class="kw">uniroot</span>(Ak,<span class="dt">lower=</span><span class="fl">1e-4</span>,<span class="dt">upper=</span><span class="kw">sqrt</span>(K[i])<span class="op">-</span>(<span class="fl">1e-4</span>),<span class="dt">k=</span>K[i])<span class="op">$</span>root
}
ipts <span class="co">#output the result(Wrong)</span></code></pre></div>
<pre><code>##  [1]  1.492103  1.533549  1.562768  1.584421  1.601192  1.614517  1.625391
##  [8]  1.634409  1.642004  1.648565  1.654167  1.659099  1.663452  1.667288
## [15]  1.670736  1.673840  1.676588  1.679139  1.681461  4.795732  4.898879
## [22]  4.999900  9.999900 22.360580 31.622677</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Check the ipts, we can find that K&gt;=23 leads to ipts arrive at right endpoint.
## at right endpoint. Which may be wrong.
## So we should chang the right endpoint based on the curves.
k=<span class="dv">23</span>  ## for example
x=<span class="kw">seq</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">1e-4</span>,<span class="dt">length=</span><span class="dv">1000</span>)
y=<span class="kw">Ak</span>(x,k)
<span class="kw">plot</span>(x,y,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## The curve shows that the null point is smaller than 3.
## For other k is the same result.
## So chang the right endpoint to 3.
wrong=<span class="kw">which</span>(K<span class="op">&gt;</span><span class="dv">22</span>)
<span class="cf">for</span> (i <span class="cf">in</span> wrong){
  ipts[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(Ak,<span class="dt">lower =</span><span class="fl">1e-4</span>,<span class="dt">upper=</span><span class="dv">3</span>,<span class="dt">k=</span>K[i])<span class="op">$</span>root
}
<span class="kw">names</span>(ipts)=K
ipts   ## the final result</code></pre></div>
<pre><code>##        4        5        6        7        8        9       10       11 
## 1.492103 1.533549 1.562768 1.584421 1.601192 1.614517 1.625391 1.634409 
##       12       13       14       15       16       17       18       19 
## 1.642004 1.648565 1.654167 1.659099 1.663452 1.667288 1.670736 1.673840 
##       20       21       22       23       24       25      100      500 
## 1.676588 1.679139 1.681461 1.683594 1.685546 1.687347 1.720601 1.729747 
##     1000 
## 1.730899</code></pre>
</div>
<div id="homework-2018-11-30" class="section level2">
<h2>Homework-2018-11-30</h2>
</div>
<div id="question1-3" class="section level2">
<h2>Question1</h2>
<ul>
<li>Write a function to compute the cdf of the Cauchy distribution, which has density <span class="math display">\[\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2),-\infty&lt;x&lt;\infty}\]</span>, where <span class="math inline">\(\theta&gt;0\)</span>. Compare your results to the results from the R function pcauchy. (Also see the source code in pcauchy.c.)</li>
</ul>
</div>
<div id="answer1-3" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nloptr)</code></pre></div>
<pre><code>## Warning: 程辑包'nloptr'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f&lt;-<span class="cf">function</span>(y,eta,theta){
<span class="co">#theta is scale parameter</span>
<span class="co">#eta is the location parameter</span>
<span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span><span class="fl">3.141592653</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((y<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>))
}

<span class="co"># the cauchy pdf</span>
p_cauchy&lt;-<span class="cf">function</span>(x,eta,theta,<span class="dt">lower.tail=</span><span class="ot">TRUE</span>){
 <span class="cf">if</span>(lower.tail) res&lt;-<span class="kw">integrate</span>(f,<span class="dt">lower =</span> <span class="op">-</span><span class="ot">Inf</span>,<span class="dt">upper =</span> x,<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,<span class="dt">theta=</span>theta,<span class="dt">eta=</span>eta)
 <span class="cf">else</span> res&lt;-<span class="kw">integrate</span>(f,<span class="dt">lower =</span> x,<span class="dt">upper =</span> <span class="ot">Inf</span>,<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,<span class="dt">theta=</span>theta,<span class="dt">eta=</span>eta)
  <span class="kw">return</span>(res<span class="op">$</span>value)
}
##compare
<span class="kw">p_cauchy</span>(<span class="dt">x=</span><span class="dv">0</span>,<span class="dt">eta =</span> <span class="dv">0</span>,<span class="dt">theta =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pcauchy</span>(<span class="dv">0</span>,<span class="dt">location =</span> <span class="dv">0</span>,<span class="dt">scale =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">p_cauchy</span>(<span class="dt">x=</span><span class="dv">1</span>,<span class="dt">eta =</span><span class="dv">3</span>,<span class="dt">theta =</span> <span class="dv">2</span>,<span class="dt">lower.tail =</span> F )</code></pre></div>
<pre><code>## [1] 0.75</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pcauchy</span>(<span class="dv">1</span>,<span class="dt">location =</span> <span class="dv">3</span>,<span class="dt">scale =</span> <span class="dv">2</span>,<span class="dt">lower.tail =</span> F)</code></pre></div>
<pre><code>## [1] 0.75</code></pre>
<ul>
<li>The reslt show that we get the right result.</li>
</ul>
</div>
<div id="question2-2" class="section level2">
<h2>Question2</h2>
<ul>
<li>A-B-O blood type problem</li>
<li><p>Let the three alleles be A, B, and O.</p>
<pre><code>|          |    |    |    |    |    |    |   |
|:---------|:---|:---|:---|:---|:---|:---|:--|
|Genotype  |AA  |BB  |OO  |AO  |BO  |AB  |AA |
|Frequency |p2  |q2  |r2  |2pr |2qr |2pq |1  |
|Count     |nAA |nBB |nOO |nAO |nBO |nAB |n  |</code></pre></li>
<li><p>Observed data: <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=28\)</span> (A-type), <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=24\)</span> (B-type), <span class="math inline">\(n_{OO}=41\)</span> (O-type), <span class="math inline">\(n_{AB}=70\)</span> (AB-type).</p></li>
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p></li>
<li><p>Record the maximum likelihood values in M-steps, are they increasing?</p></li>
</ul>
</div>
<div id="answer2-3" class="section level2">
<h2>Answer2</h2>
<ul>
<li>We can obtain the data likelihood which is <span class="math display">\[l(p,q|n_{AA},n_{BB},n_{OO},n_{A.},n_{B.},n_{AB})=2n_{AA}log(p)+2n_{BB}log(q)+2n_{OO}log(r)+(n_{A.}-n_{AA})log(2pr)+(n_{B.}-n_{BB})log(2qr)+n_{AB}log(2pq) \]</span> where <span class="math inline">\(r=1-p-q\)</span>. So we have to minimize <span class="math inline">\(-E[l(p,q|n_{AA},n_{BB},n_{OO},n_{A.},n_{B.},n_{AB})]\)</span>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N&lt;-<span class="dv">10000</span> <span class="co">#max. number of iterations </span>
tol&lt;-.Machine<span class="op">$</span>double.eps 
L.old&lt;-<span class="kw">c</span>(.<span class="dv">2</span>,.<span class="dv">35</span>)  <span class="co">#initial est. for p and q </span>
M.value&lt;-<span class="dv">0</span>
L.list&lt;-<span class="kw">data.frame</span>(<span class="dt">p=</span><span class="dv">0</span>,<span class="dt">q=</span><span class="dv">0</span>)

mlef&lt;-<span class="cf">function</span>(l,l.old,<span class="dt">n.A=</span><span class="dv">28</span>,<span class="dt">n.B=</span><span class="dv">24</span>,<span class="dt">n.OO=</span><span class="dv">41</span>,<span class="dt">n.AB=</span><span class="dv">70</span> ){
r&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(l)
r.old&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(l.old)
n.AA&lt;-n.A<span class="op">*</span>l.old[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(l.old[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>l.old[<span class="dv">1</span>]<span class="op">*</span>r.old)
n.BB&lt;-n.B<span class="op">*</span>l.old[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(l.old[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>l.old[<span class="dv">2</span>]<span class="op">*</span>r.old)
llh&lt;-<span class="dv">2</span><span class="op">*</span>n.OO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>n.AB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>l[<span class="dv">1</span>]<span class="op">*</span>l[<span class="dv">2</span>])<span class="op">+</span>
<span class="dv">2</span><span class="op">*</span>n.AA<span class="op">*</span><span class="kw">log</span>(l[<span class="dv">1</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n.BB<span class="op">*</span><span class="kw">log</span>(l[<span class="dv">2</span>])<span class="op">+</span>
(n.A<span class="op">-</span>n.AA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>l[<span class="dv">1</span>]<span class="op">*</span>r)<span class="op">+</span>(n.B<span class="op">-</span>n.BB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>l[<span class="dv">2</span>]<span class="op">*</span>r)
<span class="op">-</span>llh
}

<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
res&lt;-<span class="kw">optim</span>(<span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.2</span>),mlef,<span class="dt">l.old=</span>L.old)
L&lt;-res<span class="op">$</span>par
L.list[j,]&lt;-L
M.value[j]&lt;-<span class="st"> </span><span class="op">-</span>res<span class="op">$</span>value
<span class="cf">if</span>(<span class="kw">sum</span>(<span class="kw">abs</span>(L<span class="op">-</span>L.old)<span class="op">/</span>L.old)<span class="op">&lt;</span>tol) <span class="cf">break</span> 
L.old&lt;-L
}
L.list  <span class="co">#p,q</span></code></pre></div>
<pre><code>##           p         q
## 1 0.3162480 0.3089572
## 2 0.3261096 0.3097918
## 3 0.3272154 0.3102683
## 4 0.3273629 0.3103240
## 5 0.3273616 0.3103873
## 6 0.3273694 0.3104224
## 7 0.3273694 0.3104224</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="op">-</span>M.value)  ##the max likelihood values</code></pre></div>
<pre><code>## [1] 280.5184 283.4468 283.8634 283.9254 283.9334 283.9358 283.9374</code></pre>
</div>
<div id="homework-2018-12-07" class="section level2">
<h2>Homework-2018-12-07</h2>
</div>
<div id="question1-4" class="section level2">
<h2>Question1</h2>
<ul>
<li>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list(<br />
<span class="math inline">\(mpg \sim disp,\)</span><br />
<span class="math inline">\(mpg \sim I(1 / disp),\)</span><br />
<span class="math inline">\(mpg \sim disp + wt,\)</span><br />
<span class="math inline">\(mpg \sim I(1 / disp) + wt.\)</span><br />
)</li>
</ul>
</div>
<div id="answer1-4" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="kw">attach</span>(mtcars)
formulas &lt;-<span class="st"> </span><span class="kw">list</span>( mpg <span class="op">~</span><span class="st"> </span>disp, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt )
<span class="co">#loops</span>
output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){
  output[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]])
}
output</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#lapply</span>
<span class="kw">lapply</span>(formulas,lm)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question2-3" class="section level2">
<h2>Question2</h2>
<ul>
<li>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</li>
</ul>
</div>
<div id="answer2-4" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
  mtcars[rows, ] })

<span class="co">#loops</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){
  <span class="kw">print</span>(<span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data =</span>bootstraps[[i]]))
}</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.0287      -0.0434  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.44060     -0.03799  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.92155     -0.03918  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.10046     -0.04044  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.76035     -0.04505  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.49804     -0.04948  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.77795     -0.04433  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.23589     -0.04872  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47647     -0.03299  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.61819     -0.03719</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#lapply</span>
<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.0287      -0.0434  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.44060     -0.03799  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.92155     -0.03918  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.10046     -0.04044  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.76035     -0.04505  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.49804     -0.04948  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.77795     -0.04433  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.23589     -0.04872  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47647     -0.03299  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.61819     -0.03719</code></pre>
</div>
<div id="question3-2" class="section level2">
<h2>Question3</h2>
<p>For each model in the previous two exercises,extract <span class="math inline">\(R^2\)</span> using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer3-3" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary.lm</span>(mod)<span class="op">$</span>r.squared
<span class="co">#loops</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {
 <span class="kw">print</span>( <span class="kw">rsq</span>(<span class="kw">lm</span>(formulas[[i]])))
  }</code></pre></div>
<pre><code>## [1] 0.7183433
## [1] 0.8596865
## [1] 0.7809306
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#lapply</span>
<span class="kw">lapply</span>(<span class="kw">lapply</span>(formulas,lm),rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#loops</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){
  <span class="kw">print</span>(<span class="kw">rsq</span>(<span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data =</span>bootstraps[[i]])))
}</code></pre></div>
<pre><code>## [1] 0.7475099
## [1] 0.7179526
## [1] 0.7571433
## [1] 0.6921848
## [1] 0.8488426
## [1] 0.7702828
## [1] 0.7491175
## [1] 0.7843995
## [1] 0.677981
## [1] 0.7887093</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#lapply</span>
<span class="kw">lapply</span>(<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp),rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7475099
## 
## [[2]]
## [1] 0.7179526
## 
## [[3]]
## [1] 0.7571433
## 
## [[4]]
## [1] 0.6921848
## 
## [[5]]
## [1] 0.8488426
## 
## [[6]]
## [1] 0.7702828
## 
## [[7]]
## [1] 0.7491175
## 
## [[8]]
## [1] 0.7843995
## 
## [[9]]
## [1] 0.677981
## 
## [[10]]
## [1] 0.7887093</code></pre>
</div>
<div id="question4-2" class="section level2">
<h2>Question4</h2>
<ul>
<li>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</li>
</ul>
</div>
<div id="answer4-2" class="section level2">
<h2>Answer4</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#using anonymous function</span>
trials &lt;-<span class="st"> </span><span class="kw">replicate</span>( <span class="dv">100</span>, <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), <span class="dt">simplify =</span> <span class="ot">FALSE</span> )
p_value&lt;-<span class="cf">function</span>(mod) mod<span class="op">$</span>p.value
<span class="kw">sapply</span>(trials, p_value)</code></pre></div>
<pre><code>##   [1] 0.807919932 0.665511753 0.827771652 0.534899644 0.211737338
##   [6] 0.528643574 0.036299941 0.016286246 0.812200341 0.183029433
##  [11] 0.045674206 0.420195198 0.577173408 0.874254166 0.677908319
##  [16] 0.347553226 0.361554497 0.918737314 0.559098294 0.002509499
##  [21] 0.768217661 0.898061689 0.003256698 1.000000000 0.160902588
##  [26] 0.968015378 0.945869071 0.487230574 0.790842602 0.312865917
##  [31] 0.526127245 0.960313898 0.408238277 0.535864285 0.129220433
##  [36] 0.521667733 0.952101571 0.929053803 0.971746957 0.011601477
##  [41] 0.374260383 0.692475913 0.153917384 0.645121214 0.181853971
##  [46] 0.224322502 0.163462092 1.000000000 0.826032130 0.679110040
##  [51] 0.371457538 0.839837144 0.503046077 0.201307366 0.383173622
##  [56] 0.528297119 0.146797813 0.148537031 0.069654366 0.165229047
##  [61] 0.295638950 0.895620390 0.219622769 0.843794785 0.313497276
##  [66] 0.815388972 0.232485704 0.992897313 0.894949409 0.737031460
##  [71] 0.033341396 0.915558739 0.605572394 0.295777799 0.838840978
##  [76] 0.574006877 0.156308726 0.912461904 0.312905736 0.673237060
##  [81] 0.868453722 0.165275770 0.776816328 0.170876446 0.888611596
##  [86] 0.345857314 0.804162036 0.587077292 0.419642761 0.018360012
##  [91] 0.771416249 0.745960582 0.239627472 0.824506887 0.990644333
##  [96] 0.290741422 0.594800048 0.272107922 0.981034416 0.947306215</code></pre>
</div>
<div id="question5" class="section level2">
<h2>Question5</h2>
<ul>
<li>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</li>
</ul>
</div>
<div id="answer5" class="section level2">
<h2>Answer5</h2>
<ul>
<li>This answer need the output of the function to be the same mode.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Mvap&lt;-<span class="cf">function</span> (f,n,type, ...) {  <span class="co">#n is the length of output of function f. type is the mode of output of function f.</span>
  f &lt;-<span class="st"> </span><span class="kw">match.fun</span>(f)
  tt=<span class="kw">Map</span>(f, ...)
  <span class="cf">if</span>(type<span class="op">==</span><span class="st">&quot;numeric&quot;</span>)  y=<span class="kw">vapply</span>(tt,cbind,<span class="kw">numeric</span>(n))
  <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;character&quot;</span>) y=<span class="kw">vapply</span>(tt,cbind,<span class="kw">character</span>(n))
  <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;complex&quot;</span>) y=<span class="kw">vapply</span>(tt,cbind,<span class="kw">complex</span>(n))
  <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;logical&quot;</span>) y=<span class="kw">vapply</span>(tt,cbind,<span class="kw">logical</span>(n))
  <span class="kw">return</span>(y)
}
<span class="co">#example</span>
kk&lt;-<span class="cf">function</span>(x,w){
  y=<span class="kw">weighted.mean</span>(x, w, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
  <span class="kw">return</span>(<span class="kw">c</span>(<span class="dv">1</span>,y))
}
xs &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">5</span>, <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">simplify =</span> <span class="ot">FALSE</span>)
ws &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">5</span>, <span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)
<span class="kw">Mvap</span>(kk,<span class="dv">2</span>,<span class="st">&quot;numeric&quot;</span>,xs, ws)</code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
## [2,] 0.4163252 0.3479474 0.3209095 0.3879594 0.4020368</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.matrix</span>(<span class="kw">Mvap</span>(kk,<span class="dv">2</span>,<span class="st">&quot;numeric&quot;</span>,xs, ws))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="homework-2018.12.14" class="section level2">
<h2>Homework-2018.12.14</h2>
</div>
<div id="question1-5" class="section level2">
<h2>Question1</h2>
<ul>
<li>Make a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. You can try simplifying chisq.test() or by coding from the mathematical definition (<a href="http://en" class="uri">http://en</a>. wikipedia.org/wiki/Pearson%27s_chi-squared_test).</li>
</ul>
</div>
<div id="answer1-5" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new.chisq.test&lt;-<span class="cf">function</span>(x,y){
<span class="cf">if</span>(<span class="op">!</span><span class="kw">is.vector</span>(x) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.vector</span>(y))
<span class="kw">stop</span>(<span class="st">&quot;at least one of 'x' and 'y' is not a vector&quot;</span>)
<span class="cf">if</span>(<span class="kw">typeof</span>(x)<span class="op">==</span><span class="st">&quot;character&quot;</span> <span class="op">||</span><span class="st"> </span><span class="kw">typeof</span>(y)<span class="op">==</span><span class="st">&quot;character&quot;</span>)
<span class="kw">stop</span>(<span class="st">&quot;at least one of 'x' and 'y' is not a numeric vector&quot;</span>)
<span class="cf">if</span>(<span class="kw">any</span>(x<span class="op">&lt;</span><span class="dv">0</span>) <span class="op">||</span><span class="st"> </span><span class="kw">anyNA</span>(x)) 
<span class="kw">stop</span>(<span class="st">&quot;all entries of 'x' must be nonnegative and finite&quot;</span>)
<span class="cf">if</span>(<span class="kw">any</span>(y<span class="op">&lt;</span><span class="dv">0</span>) <span class="op">||</span><span class="st"> </span><span class="kw">anyNA</span>(y)) 
<span class="kw">stop</span>(<span class="st">&quot;all entries of 'y' must be nonnegative and finite&quot;</span>)
<span class="cf">if</span>((n&lt;-<span class="kw">sum</span>(x))<span class="op">==</span><span class="dv">0</span>) 
<span class="kw">stop</span>(<span class="st">&quot;at least one entry of 'x' must be positive&quot;</span>)
<span class="cf">if</span>((n&lt;-<span class="kw">sum</span>(x))<span class="op">==</span><span class="dv">0</span>) 
<span class="kw">stop</span>(<span class="st">&quot;at least one entry of 'x' must be positive&quot;</span>)
<span class="cf">if</span>(<span class="kw">length</span>(x)<span class="op">!=</span><span class="kw">length</span>(y)) 
<span class="kw">stop</span>(<span class="st">&quot;'x' and 'y' must have the same length&quot;</span>)
DNAME&lt;-<span class="kw">paste</span>(<span class="kw">deparse</span>(<span class="kw">substitute</span>(x)),<span class="st">&quot;and&quot;</span>,<span class="kw">deparse</span>(<span class="kw">substitute</span>(y)))
METHOD&lt;-<span class="st">&quot;Pearson's Chi-squared test&quot;</span>
x&lt;-<span class="kw">rbind</span>(x,y)
nr&lt;-<span class="kw">as.integer</span>(<span class="kw">nrow</span>(x));nc&lt;-<span class="kw">as.integer</span>(<span class="kw">ncol</span>(x))
sr&lt;-<span class="kw">rowSums</span>(x);sc&lt;-<span class="kw">colSums</span>(x);n&lt;-<span class="kw">sum</span>(x)
E&lt;-<span class="kw">outer</span>(sr,sc,<span class="st">&quot;*&quot;</span>)<span class="op">/</span>n
STATISTIC&lt;-<span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span>E)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)
<span class="kw">names</span>(STATISTIC)&lt;-<span class="st">&quot;X-squared&quot;</span>
<span class="kw">structure</span>(<span class="kw">list</span>(<span class="dt">statistic=</span>STATISTIC,<span class="dt">method=</span>METHOD,<span class="dt">data.name=</span>DNAME),<span class="dt">class=</span><span class="st">&quot;htest&quot;</span>)
}

<span class="co">#example</span>
a&lt;-<span class="kw">c</span>(<span class="dv">568</span>,<span class="dv">327</span>,<span class="dv">494</span>);b&lt;-<span class="kw">c</span>(<span class="dv">484</span>,<span class="dv">339</span>,<span class="dv">444</span>)    
<span class="kw">new.chisq.test</span>(a,b)        </code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test
## 
## data:  a and b
## X-squared = 3.9932</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(<span class="kw">rbind</span>(a,b))</code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test
## 
## data:  rbind(a, b)
## X-squared = 3.9932, df = 2, p-value = 0.1358</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">microbenchmark</span>(<span class="dt">t1=</span><span class="kw">new.chisq.test</span>(a,b),<span class="dt">t2=</span><span class="kw">chisq.test</span>(<span class="kw">rbind</span>(a,b)))  </code></pre></div>
<pre><code>## Unit: microseconds
##  expr    min     lq     mean median      uq     max neval
##    t1 42.667 45.220 53.60754 47.590 58.5305 171.397   100
##    t2 63.453 65.642 80.57874 68.012 84.9700 265.118   100</code></pre>
</div>
<div id="question2-4" class="section level2">
<h2>Question2</h2>
<ul>
<li>Can you make a faster version of table() for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</li>
</ul>
</div>
<div id="answer2-5" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new.table&lt;-<span class="cf">function</span>(...,<span class="dt">dnn =</span> <span class="kw">list.names</span>(...),<span class="dt">deparse.level =</span> <span class="dv">1</span>){
    list.names &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
        l &lt;-<span class="st"> </span><span class="kw">as.list</span>(<span class="kw">substitute</span>(<span class="kw">list</span>(...)))[<span class="op">-</span>1L]
        nm &lt;-<span class="st"> </span><span class="kw">names</span>(l)
        fixup &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">is.null</span>(nm)) 
            <span class="kw">seq_along</span>(l)
        <span class="cf">else</span> nm <span class="op">==</span><span class="st"> &quot;&quot;</span>
        dep &lt;-<span class="st"> </span><span class="kw">vapply</span>(l[fixup], <span class="cf">function</span>(x) <span class="cf">switch</span>(deparse.level <span class="op">+</span><span class="st"> </span>
<span class="st">            </span><span class="dv">1</span>, <span class="st">&quot;&quot;</span>, <span class="cf">if</span> (<span class="kw">is.symbol</span>(x)) <span class="kw">as.character</span>(x) <span class="cf">else</span> <span class="st">&quot;&quot;</span>, 
            <span class="kw">deparse</span>(x, <span class="dt">nlines =</span> <span class="dv">1</span>)[1L]), <span class="st">&quot;&quot;</span>)
        <span class="cf">if</span> (<span class="kw">is.null</span>(nm)) 
            dep
        <span class="cf">else</span> {
            nm[fixup] &lt;-<span class="st"> </span>dep
            nm
        }
    }
    args &lt;-<span class="st"> </span><span class="kw">list</span>(...)
    <span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(args)) 
        <span class="kw">stop</span>(<span class="st">&quot;nothing to tabulate&quot;</span>)
    <span class="cf">if</span> (<span class="kw">length</span>(args) <span class="op">==</span><span class="st"> </span>1L <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.list</span>(args[[1L]])) {
        args &lt;-<span class="st"> </span>args[[1L]]
        <span class="cf">if</span> (<span class="kw">length</span>(dnn) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(args)) 
            dnn &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(argn &lt;-<span class="st"> </span><span class="kw">names</span>(args))) 
                argn
            <span class="cf">else</span> <span class="kw">paste</span>(dnn[1L], <span class="kw">seq_along</span>(args), <span class="dt">sep =</span> <span class="st">&quot;.&quot;</span>)
    }
    bin &lt;-<span class="st"> </span>0L
    lens &lt;-<span class="st"> </span><span class="ot">NULL</span>
    dims &lt;-<span class="st"> </span><span class="kw">integer</span>()
    pd &lt;-<span class="st"> </span>1L
    dn &lt;-<span class="st"> </span><span class="ot">NULL</span>
    <span class="cf">for</span> (a <span class="cf">in</span> args) {
        <span class="cf">if</span> (<span class="kw">is.null</span>(lens)) 
            lens &lt;-<span class="st"> </span><span class="kw">length</span>(a)
        <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">length</span>(a) <span class="op">!=</span><span class="st"> </span>lens) 
            <span class="kw">stop</span>(<span class="st">&quot;all arguments must have the same length&quot;</span>)
        fact.a &lt;-<span class="st"> </span><span class="kw">is.factor</span>(a)
        <span class="cf">if</span> (<span class="op">!</span>fact.a) {
            a0 &lt;-<span class="st"> </span>a
            a &lt;-<span class="st"> </span><span class="kw">factor</span>(a)
        }
        ll &lt;-<span class="st"> </span><span class="kw">levels</span>(a)
        a &lt;-<span class="st"> </span><span class="kw">as.integer</span>(a)
        nl &lt;-<span class="st"> </span><span class="kw">length</span>(ll)
        dims &lt;-<span class="st"> </span><span class="kw">c</span>(dims, nl)
        dn &lt;-<span class="st"> </span><span class="kw">c</span>(dn, <span class="kw">list</span>(ll))
        bin &lt;-<span class="st"> </span>bin <span class="op">+</span><span class="st"> </span>pd <span class="op">*</span><span class="st"> </span>(a <span class="op">-</span><span class="st"> </span>1L)
        pd &lt;-<span class="st"> </span>pd <span class="op">*</span><span class="st"> </span>nl
    }
    <span class="kw">names</span>(dn) &lt;-<span class="st"> </span>dnn
    bin &lt;-<span class="st"> </span>bin[<span class="op">!</span><span class="kw">is.na</span>(bin)]
    <span class="cf">if</span> (<span class="kw">length</span>(bin)) 
        bin &lt;-<span class="st"> </span>bin <span class="op">+</span><span class="st"> </span>1L
    y &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">tabulate</span>(bin, pd), dims, <span class="dt">dimnames =</span> dn)
    <span class="kw">class</span>(y) &lt;-<span class="st"> &quot;table&quot;</span>
    y
}

<span class="co">#example</span>
a&lt;-b&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)            
<span class="kw">new.table</span>(a,b)</code></pre></div>
<pre><code>##    b
## a   1 2 3
##   1 2 0 0
##   2 0 1 0
##   3 0 0 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(a,b)</code></pre></div>
<pre><code>##    b
## a   1 2 3
##   1 2 0 0
##   2 0 1 0
##   3 0 0 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">microbenchmark</span>(<span class="dt">t1=</span><span class="kw">new.table</span>(a,b),<span class="dt">t2=</span><span class="kw">table</span>(a,b))    </code></pre></div>
<pre><code>## Unit: microseconds
##  expr     min       lq     mean   median      uq     max neval
##    t1 113.414 120.3425 139.4698 123.2605 142.588 303.773   100
##    t2 126.542 132.1945 146.0922 135.2940 143.135 323.830   100</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
